---
import Layout from '../layouts/Layout.astro'

const response = await fetch(
  `https://suttacentral.net/api/menu?language=${Astro.currentLocale?.split('-')[0] || 'en'}`
)
const json = await response.json()
const tipitaka = json
  .filter(m => ['sutta', 'vinaya', 'abhidhamma'].includes(m.uid))
  .reverse()
---

<Layout>
  <h1>Tipiṭaka—the Three Baskets of the Buddhist canon</h1>
  <ol>
    {
      tipitaka.map(pitaka => (
        <li>
          <article>
            <h2>
              <a href={`/pitaka/${pitaka.uid}`}>
                {pitaka.root_name}—{pitaka.translated_name}
              </a>
            </h2>
            {!!pitaka.blurb && <p set:html={pitaka.blurb} />}
          </article>
        </li>
      ))
    }
  </ol>
</Layout>
